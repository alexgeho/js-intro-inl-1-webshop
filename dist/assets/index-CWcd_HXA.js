(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))b(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&b(p)}).observe(document,{childList:!0,subtree:!0});function g(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function b(o){if(o.ep)return;o.ep=!0;const u=g(o);fetch(o.href,u)}})();const D=[{id:1,name:"Detaljer f√∂r ventil",price:25,rating:4.2,category:"bockad-armering",images:["vara1.png","vara1-2.png"]},{id:2,name:"F√§stdon",price:22,rating:3.8,category:"bockad-armering",images:["vara2.png","vara2-2.png"]},{id:3,name:"F√∂rst√§rkningskorgar f√∂r pelare",price:28,rating:4.7,category:"bockad-armering",images:["vara3.png","vara3-2.png"]},{id:4,name:"F√∂rst√§rkningskorgar f√∂r fundament",price:30,rating:4.3,category:"for-pelare",images:["vara4.png","vara4-2.png"]},{id:5,name:"F√∂rst√§rkningskorgar f√∂r v√§ggar",price:29,rating:4.1,category:"for-pelare",images:["vara5.png","vara5-2.png"]},{id:6,name:"F-detalj",price:31,rating:4.5,category:"for-pelare",images:["vara3.png","vara3-2.png"]},{id:7,name:"G-detalj",price:35,rating:4.8,category:"for-fundament",images:["vara4.png","vara4-2.png"]},{id:8,name:"H-detalj",price:34,rating:4.4,category:"for-fundament",images:["vara4.png","vara4-2.png"]},{id:9,name:"I-detalj",price:36,rating:4.9,category:"for-fundament",images:["vara4.png","vara4-2.png"]},{id:10,name:"J-detalj",price:37,rating:4.6,category:"for-fundament",images:["vara4.png","vara4-2.png"]},{id:11,name:"K-detalj",price:30,rating:4,category:"for-vaggar",images:["vara5.png","vara5-2.png"]},{id:12,name:"L-detalj",price:32,rating:4.4,category:"for-vaggar",images:["vara5.png","vara5-2.png"]},{id:13,name:"M-detalj",price:25,rating:4.1,category:"for-vaggar",images:["vara5.png","vara5-2.png"]},{id:14,name:"N-detalj",price:20,rating:3.9,category:"for-vaggar",images:["vara5.png","vara5-2.png"]},{id:99,name:"Hj√§rtformad munk",price:0,category:"special",images:["heart.png"]}];function A(i){return`${i.getFullYear()}-${N(i.getMonth()+1)}-${N(i.getDate())}`}function N(i){return String(i).padStart(2,"0")}function R(){const i=document.querySelector("#openCloseNavMenu"),l=document.querySelector("#navBugerJs");i.addEventListener("click",g),l.addEventListener("click",g);function g(){i.classList.toggle("open"),l.classList.toggle("open")}}const m=[];function U(i){const l=document.querySelector("#cart"),g=document.querySelector("#cartTotal");function b(e){const t=Number(e.target.dataset.id),s=i.find(S=>S.id===t);if(s===void 0)return;const d=document.querySelector(`#amount-${t}`),n=Number(d.value),v=n>0?n:1,L=m.findIndex(S=>S.id===t);L===-1?m.push({...s,amount:v}):m[L].amount+=v,r(),y()}const o=document.querySelector("#checkoutForm");let u=null;const p=900*1e3;function k(){clearTimeout(u),u=setTimeout(()=>{o.reset(),alert("Best√§llningen avbr√∂ts ‚Äì du var f√∂r l√•ngsam."),o.style.display="none"},p)}const M=document.querySelector("#cartMessages");function E(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),s=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-s);const d=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-d)/864e5+1)/7)}const C=document.querySelector("#discountCode");function r(e=new Date){e.getDay()===2?document.body.classList.add("fettisdagen"):document.body.classList.remove("fettisdagen");const s=[];if(e.getDate()===14&&e.getMonth()===1){const c=i.find(h=>h.name==="Hj√§rtformad munk");c&&m.findIndex(x=>x.name==="Hj√§rtformad munk")===-1&&(m.push({...c,amount:1}),s.push("Alla Hj√§rtans Dag: Hj√§rtformad munk lades till üéÅ"))}let n=m.reduce((c,h)=>c+h.price*h.amount,0);const v=document.querySelector('input[name="payment"][value="invoice"]');n>800?(v.disabled=!0,v.checked&&(v.checked=!1)):v.disabled=!1;const L=e.getDay()===1,S=e.getHours()<10;if(L&&S){const c=n*.1;n-=c,s.push("M√•ndagsrabatt: ‚àí10 %")}const T=e.getDay(),B=e.getHours(),F=T===5&&B>=15,I=T===6,H=T===0,O=T===1&&B<3,$=F||I||H||O;if($){const c=n*.15;n+=c}m.forEach(c=>{if(c.amount>=10){const h=c.price*c.amount*.1;n-=h,s.push(`M√§ngdrabatt: ‚àí10 % p√• ${c.name}`)}});const P=E(e)%2===0,j=e.getDay()===2;if(P&&j&&n>25&&(n-=25,s.push("Tisdagsrabatt: ‚àí25 kr")),m.reduce((c,h)=>c+h.amount,0)<=15&&n>0){const c=25+n*.1;n+=c,s.push(`Frakt: ${Math.round(c)} kr`)}else s.push("Fri frakt");let q="";if(T===5&&B>=11&&B<13)q="Leverans kl. 15:00 p.g.a. veckom√∂te";else{let c=30;$&&(c=90),B>=0&&B<5&&(c=45),q=`Leverans om ca ${c} minuter`}s.push(q),C?.value.trim()==="a_damn_fine-cup_of-coffee"&&(n=0,s.length=0,s.push("Rabattkod: hela best√§llningen √§r gratis ‚òï")),g.textContent=`Totalt: ${Math.round(n)} kr`,M.innerHTML=s.map(c=>`<p>${c}</p>`).join(""),a()}C.addEventListener("input",()=>{r()});function a(){g.classList.add("highlight-price"),setTimeout(f,1e3*1.5)}function f(){g.classList.remove("highlight-price")}function y(){l.innerHTML="";for(let e=0;e<m.length;e++)l.innerHTML+=`
    <article>
      ${m[e].name}:
      <button data-id="${e}" class="decrease-cart-product">-</button>
      ${m[e].amount} st
      <button data-id="${e}" class="increase-cart-product">+</button>
      <button data-id="${e}" class="delete-product">Radera</button>
    </article> 
    `;l.innerHTML+=`
  <div class="cartOrder">
    <button class="orderCartBtn" type="button">Best√§ll</button>
    <button class="closeCheckoutBtn" type="button">X</button>
  </div>
`}document.addEventListener("click",e=>{e.target.classList.contains("buy")&&b(e)}),l.addEventListener("click",e=>{if(e.target.classList.contains("decrease-cart-product")){const t=Number(e.target.dataset.id);m[t].amount>1?m[t].amount-=1:m.splice(t,1),r(),y();return}if(e.target.classList.contains("increase-cart-product")){const t=Number(e.target.dataset.id);m[t].amount+=1,r(),y();return}if(e.target.classList.contains("delete-product")){const t=Number(e.target.dataset.id);m.splice(t,1),r(),y();return}}),l.addEventListener("click",e=>{if(e.target.closest(".orderCartBtn")){const t=o.style.display!=="block";o.style.display=t?"block":"none",t&&k();return}if(e.target.closest(".closeCheckoutBtn")){o.style.display="none";return}})}function V(i){const l=document.querySelector("#productsList"),g=document.querySelector("#categoryFilter"),b=document.querySelector("#sortByNameBtn"),o=document.querySelector("#sortByPriceBtn"),u=document.querySelector("#sortByRatingBtn");let p=i;g.addEventListener("change",E),l.addEventListener("click",r),b.addEventListener("click",M),o.addEventListener("click",C),u.addEventListener("click",k);function k(){p.sort((e,t)=>t.rating-e.rating),a(g.value)}function M(){p.sort((e,t)=>e.name.localeCompare(t.name)),a()}function E(){p=i.filter(e=>!g.value||e.category===g.value),a()}function C(){p.sort((e,t)=>t.price-e.price),a(g.value)}function r(e){if(!e.target.classList.contains("dot"))return;const t=e.target.parentElement,s=[...t.children],d=s.indexOf(e.target),n=t.previousElementSibling,v=JSON.parse(n.dataset.images);n.src=`img/${v[d]}`,n.dataset.index=d,s.forEach((L,S)=>{L.classList.toggle("active",S===d)})}function a(){l.innerHTML="";let e="";for(let d=0;d<p.length;d++){const n=p[d];e+=`
    <article>
    <h3>${n.name}</h3>
    <p>ID: ${n.id}</p>
       <div class="img-wrap">

        <img
          src="img/${n.images[0]}"
           data-images='${JSON.stringify(n.images)}'
            data-index="0" class="product-img" 
          >

          <div class="img-dots">
            ${n.images.map((v,L)=>`<span class="dot ${L===0?"active":""}"></span>`).join("")}
          </div>

     </div>

      <div class="metadata">
          <p>Pris: ${n.price} kr</p>
          <p>Betyg: ${n.rating}/5</p>
        </div>
    <p>Categori: ${n.category}</p>

    <div class="buy-row">
    <div class="amount-row">
      <button class="decrease" min="0" data-id="${n.id}">-</button>
      <input id="amount-${n.id}" type="number" min="0" disabled>
      <button class="increase" data-id="${n.id}">+</button>
    </div>
      <button class="buy" data-id="${n.id}">K√∂p</button>
    </div>
    
    </article> 
    `}l.innerHTML=e,document.querySelectorAll("#productsList button.increase").forEach(d=>{d.addEventListener("click",f)}),document.querySelectorAll("#productsList button.decrease").forEach(d=>{d.addEventListener("click",y)}),document.querySelectorAll("#productsList button.buy")}function f(e){const t=e.target.dataset.id,s=document.querySelector(`#amount-${t}`);s.value=Number(s.value)+1}function y(e){const t=e.target.dataset.id,s=document.querySelector(`#amount-${t}`);let d=Number(s.value)-1;d<0&&(d=0),s.value=d}a()}function _(){const i=document.querySelector("#checkoutForm"),l=document.querySelector("#submitBtn");i.addEventListener("input",g),i.addEventListener("change",g);function g(){let r=i.checkValidity();const a=i.querySelector('input[name="payment"]:checked');a||(r=!1);const f=/^(\d{10}|\d{12}|\d{6}[- ]\d{4}|\d{8}[- ]\d{4})$/;function y(e){return f.test(e.trim())}a?.value==="invoice"&&(y(k.value)?k.setCustomValidity(""):(r=!1,k.setCustomValidity("Ogiltigt personnummer"))),l.disabled=!r}i.addEventListener("submit",r=>{if(!i.checkValidity()){r.preventDefault(),i.reportValidity();return}console.log("BEST√ÑLLNING OK")}),document.querySelector("#closeCheckoutBtn").addEventListener("click",()=>{i.style.display="none"});const b=document.querySelectorAll('input[name="payment"]'),o=document.querySelector("#invoiceFields"),u=document.querySelector("#cardFields"),p=u.querySelectorAll("input"),k=document.querySelector("#personnummer");b.forEach(r=>{r.addEventListener("change",()=>{const a=r.value==="card",f=r.value==="invoice";u.hidden=!a,o.hidden=!f,p.forEach(y=>{y.required=a}),k.required=f})}),i.addEventListener("input",r=>{const a=r.target;a instanceof HTMLInputElement&&a.id&&(a.dataset.touched="true",a.validity.valueMissing?E(a,"Detta f√§lt √§r obligatoriskt"):a.validity.patternMismatch?E(a,M(a)):a.validity.typeMismatch?E(a,"Ogiltigt format"):C(a))});function M(r){return r.id==="firstName"||r.id==="lastName"||r.id==="city"?"Endast bokst√§ver till√•tna":r.id==="phone"?"Ange ett giltigt telefonnummer":r.id==="email"?"Ange en giltig e-postadress":r.id==="zip"?"Ange ett giltigt postnummer":"Ogiltigt format"}function E(r,a){const f=document.getElementById(r.id+"Error");f&&(f.textContent=a)}function C(r){const a=document.getElementById(r.id+"Error");a&&(a.textContent="")}}const J=new Date;document.querySelector("#today").innerHTML=A(J);R();U(D);V(D);_();
